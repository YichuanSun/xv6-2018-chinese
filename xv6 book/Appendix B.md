# 附录 B

## boot loader

当一个x86 PC启动时，它开始运行一个叫做BIOS（基本输入/输出系统）的程序，它储存在主板上的一个非易失存储器中。BIOS的工作是准备硬件，之后将控制移交给操作系统。具体来说，BIOS将控制权移交给从主引导扇区中加载的代码，也就是主引导盘的前512字节。主引导扇区中包括boot loader：将内核加载进内存的指令。BIOS将主引导扇区加载到内存地址为0x7c00处，并之后跳转（设置处理器的%ip）到这个地址。当boot loader开始执行时，处理器会模拟一个8088处理器，loader的工作就是把处理器设为一个更加现代化的操作模式，来将xv6内核从磁盘加载到内存，之后将控制权移交给内核。xv6 boot loader 由两部分代码组成，一部分是混合16位和32位的汇编代码（bootasm.S;(9100)），另一部分是用C写的（bootmain.c;(9200)）。



## 代码：汇编引导程序

boot loader 中的第一条指令是cli(9112)，用来关处理器中断。

